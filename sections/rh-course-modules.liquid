{% assign current_product = product %}

<section class="rh-course-modules">
  <div class="container-rh">
    <h2 class="rh-section-title">{{ section.settings.title | default: 'Course Modules' }}</h2>

    {% if current_product.metafields.courses_plus_content.course_outline != blank %}
      <div class="rh-modules-list">
        {% assign course_outline = current_product.metafields.courses_plus_content.course_outline %}

        {% for module in course_outline.modules %}
          <div class="rh-module-item">
            <div class="rh-module-header">
              <h3 class="rh-module-title">{{ module.title }}</h3>
              {% if module.lessons.size > 0 %}
                <span class="rh-module-lessons">{{ module.lessons.size }} Lessons</span>
              {% endif %}
            </div>

            {% if module.description != blank %}
              <div class="rh-module-description">{{ module.description }}</div>
            {% endif %}

            {% if module.lessons.size > 0 and section.settings.show_lessons %}
              <ul class="rh-lessons-list">
                {% for lesson in module.lessons %}
                  <li class="rh-lesson-item">
                    <span class="rh-lesson-title">{{ lesson.title }}</span>
                    {% if lesson.duration %}
                      <span class="rh-lesson-duration">{{ lesson.duration }}</span>
                    {% endif %}
                  </li>
                {% endfor %}
              </ul>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    {% else %}
      {% if section.settings.show_placeholder %}
        <div class="rh-module-placeholder">
          <p>Course content will appear here once added through Course Plus.</p>
        </div>
      {% endif %}
    {% endif %}
  </div>
</section>

<style>
  .rh-course-modules {
    padding: 60px 20px;
    background-color: #000028;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
  }

  .rh-course-modules .container-rh {
    max-width: 1280px;
    margin: 0 auto;
    position: relative;
  }

  .rh-course-modules .rh-section-title {
    font-family: 'Siemens Sans', sans-serif;
    font-weight: 700;
    font-size: 36px;
    line-height: 130%;
    color: white;
    margin: 0 0 30px;
  }

  .rh-modules-list {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin-top: 30px;
  }

  .rh-module-item {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    padding: 24px;
  }

  .rh-module-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
  }

  .rh-module-title {
    font-family: 'Siemens Sans', sans-serif;
    font-weight: 600;
    font-size: 22px;
    color: white;
    margin: 0;
  }

  .rh-module-lessons {
    font-family: 'Siemens Sans', sans-serif;
    color: #00ffb9;
    font-size: 16px;
  }

  .rh-module-description {
    font-family: 'Siemens Sans', sans-serif;
    color: white;
    font-size: 16px;
    line-height: 150%;
    margin-bottom: 16px;
  }

  .rh-lessons-list {
    list-style: none;
    padding: 0;
    margin: 0;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    padding-top: 16px;
  }

  .rh-lesson-item {
    display: flex;
    justify-content: space-between;
    padding: 10px 0;
    font-family: 'Siemens Sans', sans-serif;
    color: white;
    font-size: 16px;
  }

  .rh-lesson-duration {
    color: rgba(255, 255, 255, 0.6);
  }

  .rh-module-placeholder {
    text-align: center;
    padding: 40px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    color: white;
    font-family: 'Siemens Sans', sans-serif;
  }

  @media (max-width: 768px) {
    .rh-course-modules {
      padding: 40px 20px;
    }

    .rh-module-title {
      font-size: 18px;
    }

    .rh-module-header {
      flex-direction: column;
      align-items: flex-start;
      gap: 5px;
    }
  }
</style>

{% schema %}
{
  "name": "Course Plus Modules",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Section Title",
      "default": "Course Modules"
    },
    {
      "type": "checkbox",
      "id": "show_lessons",
      "label": "Show Lessons",
      "default": true,
      "info": "Display the individual lessons within each module"
    },
    {
      "type": "checkbox",
      "id": "show_placeholder",
      "label": "Show Placeholder",
      "default": true,
      "info": "Show a placeholder message when no course content is available"
    }
  ],
  "presets": [
    {
      "name": "RH Course Plus Modules",
      "category": "Course"
    }
  ]
}
{% endschema %}
